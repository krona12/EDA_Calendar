# EDA_Calendart
EDA homework
#Krona T2101 EDA课设记录
#all rights reserved krona12
#2023/12/8

#思路
1.写日期函数
计数器重构，BCD码转换，最开始只取年后两位
后面改进，扩展到全部，重写一个BCD，使得能够将十进制的4位数，（二进制表示的）转换为BCD
2.写星期函数
蔡勒公式--蔡乐公式的改进（Verilog除法的局限性，舍去小数）
3.步进电机模拟秒针转动
4.扩展键盘
键盘与开关有复用，保留4个开关，其他用键盘逻辑
键盘只有3个能用，其他电平带不动，可能是上拉电阻阻值有问题。
行列管脚对应完全没问题
5.设计变速器，使得CP能够通过按键变化，改变计数速度。使用计数器以及数据选择实现
6.完善闹钟与闹铃，此时将排线换为跳线，否则端口不够用
7. 扩展点阵，进行点阵扫描编码


#解决bug：
1.数码管显示“模糊”，使用变量但未定义！！！
2.时分秒不能准时进位问题，重写N位计数器
3.BCD码转换失误，移位数位有问题
4.星期转换，每个月最后一天到新月第一天，多计算出一天。蔡乐公式运用错误，基于verilog小数计算舍去的问题
5.时分秒进位给到天数，天数不能进位；采用输出为reg，寄存器类型避免竞争冒险
6.调整时间时跳变；按键消抖解决

#端口说明：
ALARM A3,闹钟模块之前实验展示过，因4个端口给到步进电机，因此ALARM给到一个无用端口A3.
修正：接跳线后，闹钟、报时可保留，接LED与蜂鸣器且功能正常
#端口1.0：
M22-K1,修改分钟
N21-K2,修改时钟
Y22-K3,修改闹钟分钟
W19-K4,修改闹钟时钟
M20-K5,闹钟允许播放--准备键盘  AN2
M21-K6,修改时钟显示还是闹钟显示 AN4
L21-K7,总复位端--准备键盘 PINJ22  AN8
L22-K8,page1--键盘数字//由键盘A,B,C决定翻页
U16-K9,page0--键盘数字//
U17-K10,日期允许计数--准备键盘AN6

#端口2.0：
前四个不变
6，8，10，12 闹钟使能，显示时钟/闹钟，改变天CP：_1HZ/dayfull,总复位端
键盘ABC翻页，
AN4 CP加速，4种速度，1,2,5,10Hz
新加键盘，5，6，7，10用单个键，8，9page用数字

#接线：
先接数码管15个，DP不用接
然后接按键、键盘、按钮，除了J22,W20，K22，其他正常接即可
接4个管脚的步进电机
最后接点阵，
H21,列;J22,R1;W20,R2;B21,R3;B22,R4;0123;

#其他
关于没有成功烧录的bug
https://chipdebug.com/forum-post/20501.html
键盘扫描参考
https://blog.51cto.com/u_15075516/4680301
星期转换参考，chat，蔡乐公式
https://www.luogu.com.cn/blog/holyromanempire/ji-suan-te-ding-ri-ji-shi-xing-ji-ji-cai-le-gong-shi
https://superlova.github.io/2021/04/16/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E5%A6%82%E4%BD%95%E6%B1%82%E5%87%BA%E4%BB%BB%E6%84%8F%E6%97%A5%E6%9C%9F%E6%98%AF%E6%98%9F%E6%9C%9F%E5%87%A0%EF%BC%9F/
BCD码转换，chat
四线八相电机参考
https://blog.csdn.net/qq_35484725/article/details/118211352
